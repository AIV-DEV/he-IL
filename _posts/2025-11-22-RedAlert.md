---
layout: post
title: התרעות צבע אדום בהודעת SMS
---

"צבע אדום! צבע אדום!" כל ילד שגדל בעוטף עזה מכיר את המילים האלו, שבעוטף עזה מחליפות את האזעקה העולה והיורדת המוכרת בשאר ישראל בעת ירי טילים.

<img src="https://aiv-dev.com/he-IL/assets/images/IranMissileDawn.png" width="50%" />

*ירוט טיל איראני במבצע "עם כלביא" על רקע הזריחה*

בעת מבצע "עופרת יצוקה", בשנת תשס"ט, גרתי באחד מישובי עוטף עזה, בישוב זמני של מגורשי גוש קטיף. 4 שנים מאותו אירוע נורא בו גירשו אותם מבתיהם בשם השלום, והטרור, איך לומר? לא בדיוק הפסיק ברצועת עזה. אזעקות "צבע אדום" היו דבר די נפוץ, עוד לפני המבצע. אבל בזמן המבצע הן כמובן היו נפוצות יותר. באותה התקופה, אזעקות כאלו לא היו נפוצות בישראל. אומנם ישראל תקפה ברצועה, אך לא השמידה את הטרור. לא ב"עופרת יצוקה", לא ב"עמוד ענן" ולא ב"צוק איתן". במבצעים האחרונים, כבר נורו טילים על ירושלים ות"א, וכל אזרחי ישראל נאלצו להתרגל לכניסה לממ"דים. באותו שלב לא הייתי בעוטף, אך כבוגר העוטף - היה לי יתרון משמעותי. מאז ועד היום, אני לא נלחץ מהאזעקות, ולא מתחיל לרוץ סתם. אלא מתנהל בקור רוח, הרי בעוטף הסתדרתי עם 15 שניות, ובשאר הארץ יש לי זמן התרעה של דקה וחצי, אז יש זמן...

באופן בלתי הגיוני, ישראל המשיכה להכיל. המיגוניות בכבישי העוטף עוטרו בציורים יפים, שנרמלו את המציאות הזו. מערכות כגון "כיפת ברזל" איפשרו להכיל את האיום ולתת לארגון טרור להתחמש בטילים קצרי טווח ואף ארוכי טווח בלי שנגיב. ואז, בשנים תשע"ח-תשפ"א, התפתחה תופעת ה"סבבים" וה"טפטופים". ארגוני הטרור היו משגרים לעוטף רקטות, פצמ"רים וטילים, ובתכל'ס לא זוכים לתגובה מעבר לאיזו הפגזה קטנה על עמדה ריקה. זו הייתה תפועת הטפטופים, כשלפעמים כדי למנוע את התגובה, ארגוני הטרור המציאו תירוצים מפוברקים לגמרי - למשל, שזרם חשמלי כתוצאה מברק יזם שיגור. כשהם קצת הגזימו, וירו יותר מכמה טילים בודדים, היינו נכנסים ל"סבב" של כמה ימי לחימה - הם יורים טילים ואנחנו מפגיזים. באותן שנים הייתי בעוטף, וחוויתי את זה על בשרי. לקום ב-1 בלילה, לקפוץ ממיטת הקומותיים ולרוץ לממ"ד. להיות באוטובוס, שהנהג יספיק לעצור וכולנו נספיק להשתטח על החול בצד הכביש תוך 15 שניות. ועוד...

ועדיין הכלנו את זה.

מבצע "שומר החומות" החל אחרי שיגור טיל של חמאס לירושלים ביום ירושלים, בשנת תשפ"א, אבל גם אז, לא השמדנו את חמאס. הגענו למצב הזוי לגמרי, כאשר לפני מבצע "עלות השחר", בשנת תשפ"ב, נחסמו כל כבישי העוטף למספר ימים מחשש לירי נ"ט על הרכבים מצד ארגוני הטרור.

ו**עדיין לא השמדנו אותם**!

ואז הגיעו אירועי שמחת תורה. נכנסנו למלחמה, כאשר לכולנו ברור שהגיע הזמן להשמיד את ארגוני הטרור. הכל התפוצץ לנו בפנים; הגדרות והחומות שבנינו נפרצו, המיגוניות המקושטות נוקבו בכדורים, רימוני רסס וטילי RPG, והרוצחים העזתים טבחו, בזזו ואנסו בישובי העוטף.

ועם ישראל התעורר. היכינו את אויבינו שוק על ירך בכמה זירות בו זמנית, במלחמה רב זירתית, והעולם כולו הופתע למראה יכולותינו במבצע הביפרים, ובהמשך, (במה שבעתיד ודאי יכתבו ספרים על כל מה שקרה שם שהיום עדיין חסוי) במבצע "עם כלביא" שהתפתח ל"מלחמת 12 הימים" באיראן. המלחמה התחילה במתקפה ישראלית מתוזמנת על מתקני הגרעין האיראניים וחיסול בכירים איראניים רבים; למשל, במהלך המלחמה, הם החליפו 3 רמטכ"לים. הם שיגרו טילים - ובכוונה לעבר מרכזי אוכלוסיה ובתי חולים - אחד הטילים התפוצץ בבית החולים סורוקה.
אבל כאן, לא היו אלו אזעקות וירוטים של הכלה ותבוסתנות, אלא של עוצמה. עשינו את הבלתי יאמן והסבנו לאיראנים מכה קשה.

אבל כמובן, גם טילים ממלחמה שמגיעה ממקום של עוצמה הם טילים, וגם הם מסיבים נזק, הרס, ולעיתים למרבה הצער גם פגיעות בחיי אדם, הי"ד.

למען האמת, עוד לפני המלחמה באיראן, בטילים מתימן, בפיקוד העורף החליטו להוסיף עוד התראה, התראה כ10 דקות לפני האזעקה (שהייתה בכל מקום לפי זמן ההתגוננות שלו שאליו התרלגנו בתקופת הסבבים), כדי להכין את הציבור לירידה למקלט. במלחמה באיראן, בה היו מטחים גדולים שנמשכו מעבר ל10 דקות, השתנו ההנחיות - שעד אז היו לשהות במרחבים המוגנים כ10 דקות - לכניסה למרחב המוגן מהאזעקה ועד להודעה חדשה. מה הבעיה? האזעקה היחידה שהופעלה בצופרים, הייתה האזעקה הרגילה. ההתראות האחרות הגיעו לטלפונים דרך האפליקציה. אבל מה לעשות עם מי שיש לו טלפון פשוט או שלא התקין את האפליקציה? לשם כך השתמשו בפיקוד העורף בטכנולגיה שנקראת התראות CB, שמציגה פופאפ על מסך הטלפון עם תוכן ההתראה, ומצפצפת גם אם הטלפון על מצב שקט:


<img src="https://aiv-dev.com/he-IL/assets/images/CB_Alert.png" width="50%" />
 

 למה אני נזכר בכל זה עכשיו דווקא? שאלה טובה, למה דווקא עכשיו. 

בכל מקרה, אחרי כל ההקדמה הזו, אני רוצה להציג פיתוח שלי (ושל חברי, [שילה סיאני](https://github.com/shilosiani)) מתקופת המלחמה באיראן.
 הבעיה הייתה, שהתראות הCB הגיעו רק לטלפונים בדור 4, וגם אז לא לכולם. ופקע"ר השתמשו בטכנולוגיה הזו רק להתראות לפני האזעקה, ולא את ההתראה שמודיעה שאפשר לצאת.

 בקיצור... ישיבה בדרום הארץ (שעד אז, בגלל המיקום הנידח, לא כל כך הייתה תחת אזעקות. למעשה אפילו במלחמה עם איראן הייתה להם רק אזעקת אמת אחת) פנתה לשנינו וביקשה לפתח מערכת שתשלח את התראות פקע"ר בSMS לתלמידים.

 אז איך לעשות את זה? שליחת SMS זה החלק הקל. השתמשנו בAPI העסקי של חברת 019 (דוגמאות לשימוש בAPI ניתן למצוא כאן). אבל לקבל את התראות פיקוד העורף... אין API רשמי. אז חיפשנו ברשת, ומצאנו את קובץ הjson הזה - לפי הדיווחים ניתן לגשת אליו רק מישראל (והוא לא חוסם בכלל, חודשים אנחנו מריצים אליו בקשות ולא נחסמנו).
 
 [https://www.oref.org.il/WarningMessages/alert/alerts.json](https://www.oref.org.il/WarningMessages/alert/alerts.json)

 אז הפעלנו סקריפט פייתון שקרא את התוכן של הקובץ במשך כמה זמן, עד שהבנו את המבנה שלו, ואיך בדיוק מתעדכנות שם ההתראות, וכתבנו סקריפט פייתון שבודק כל שניה אם יש התראה חדשה, בודק אם היא במקום שהגדרנו (כדי שלא תשלח התראה בSMS על כל אזעקה ברחבי הארץ...) ואם כן מחכה 100 שניות לפני בדיקה חוזרת (כי כל התראה נשארת כדקה וחצי בקובץ הjson הזה לפני שהיא נמחקת משם). ואז ההתראה נשלחת בSMS, וככה תלמידי אותה ישיבה - שמשתמשים בטלפונים פשוטים, חלקם אפילו בדור 3, ככה שהדרכים האחרות לא היו לגמרי רלוונטיות עבורם - קיבלו את כל 3 התראות פקע"ר בSMS. לדבג את התוכנה זה די קשה, הרי אנחנו לא שולטים מה יעלה ומתי בjson של פקע"ר, נכון? אז אחרי שהבנו את מבנה הjson, יצרנו json זהה משלנו - גם הוא קיים בrepo שלנו - שאותו אפשר לשים באתר שלכם (או במקרה שלנו, בGithub pages) ולערוך את הקוד כך שיסרוק אותו.

 הנה הrepo של התוכנה:

[https://github.com/shilosiani/CobaltRedAlert](https://github.com/shilosiani/CobaltRedAlert)

בתפילה לניצחון על כל אויבינו.
